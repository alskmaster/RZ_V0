<div class="report-module-instance" {% if new_page %}style="page-break-before: always;"{% endif %}>
  <h2>{{ title or 'MTTR / MTTD por Severidade' }}</h2>

  {% if data.error %}
    <div class="alert alert-warning" role="alert">{{ data.error }}</div>
  {% endif %}

  {% if data.show_summary %}
    <div class="alert alert-info" role="alert" style="font-size: 0.95rem;">
      <strong>O que são MTTR e MTTD?</strong><br/>
      MTTR (Mean Time To Restore) é o tempo médio para restaurar o serviço, contado do início do incidente até sua resolução (OK).<br/>
      MTTD (Mean Time To Detect) aqui é medido como o tempo médio até o <em>primeiro reconhecimento</em> (ACK) do incidente, quando houver; incidentes sem ACK são ignorados no cálculo do MTTD.
    </div>
  {% endif %}

  {% if data.chart_b64 %}
    <div class="mb-3 text-center">
      <img src="data:image/png;base64,{{ data.chart_b64 }}" alt="MTTR e MTTD" style="max-width:100%; height:auto;" />
    </div>
  {% endif %}

  {% if data.rows and data.rows|length > 0 %}
    <div class="table-responsive">
      <table class="table table-sm table-striped align-middle">
        <thead>
          <tr>
            <th>Severidade</th>
            <th class="text-end">MTTR</th>
            <th class="text-end">MTTD</th>
          </tr>
        </thead>
        <tbody>
          {% for row in data.rows %}
            <tr>
              <td>{{ row.Severidade }}</td>
              <td class="text-end">{{ row.MTTR }}</td>
              <td class="text-end">{{ row.MTTD }}</td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  {% else %}
    <div class="alert alert-info" role="alert">Sem dados para exibir no período selecionado.</div>
  {% endif %}
</div>
